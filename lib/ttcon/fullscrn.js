dojo.provide("ttcon.fullscrn");dojo.require("dojo.window");
dojo.declare("ttcon.fullscrn",null,{constructor:function(a){this.VERSION="0.5.0";this.isCssCapable=false;if(this.isCssCapable=this._shouldUseCss())this.imageNode=dojo.create("div",{id:"fullscrn-bg"},dojo.body(),"first");else{this.imageNode=dojo.create("img",{id:"fullscrn-bg"},dojo.body(),"first");dojo.connect(window,"onresize",this,"resize")}this.setImage(a.image)},onImageLoading:function(){},onImageChanged:function(){},onError:function(){},_shouldUseCss:function(){var a=false;if(dojo.isSafari>4||
dojo.isFF>=3.6||dojo.isChrome>=4)a=true;return a},setImage:function(a){if(dojo.isString(a)){var c=dojo.fadeOut({node:this.imageNode}),b;dojo.connect(c,"onEnd",this,function(){if(this.isCssCapable){var e=dojo.create("img",{style:{display:"none"}},dojo.body(),"last");dojo.addClass(this.imageNode,"fullscrn-css-bg");b=e}else{dojo.destroy(this.imageNode);b=this.imageNode=dojo.create("img",{style:{opacity:0},id:"fullscrn-bg"},dojo.body(),"first")}dojo.connect(b,"onload",this,function(){var d=dojo.fadeIn({node:this.imageNode});
if(this.isCssCapable){dojo.style(this.imageNode,{backgroundImage:"url('"+a+"')"});dojo.connect(d,"onEnd",this,function(){this.onImageChanged(this.imageNode);dojo.destroy(e)})}else{this.resize();dojo.connect(d,"onEnd",this,function(){this.onImageChanged(this.imageNode)})}d.play()});dojo.connect(b,"onerror",this,function(d){this.onError(d,"The image '"+a+"' can not be found!")});this.onImageLoading(a);b.src=a});c.play()}else return false},resize:function(){var a=dojo.window.getBox(),c=a.h/a.w,b;b=dojo.position(this.imageNode);
if(c>b.h/b.w){c=a.h/b.h*b.w;b=a.h}else{c=a.w;b=a.w/b.w*b.h}dojo.marginBox(this.imageNode,{w:c,h:b,l:0-(c-a.w)/2,t:0-(b-a.h)/2})}});
